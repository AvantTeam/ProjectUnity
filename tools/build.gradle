sourceSets.main {
    java.srcDirs = ['src/']
}

ext {
    imageProcessorMain = 'unity.tools.SpriteProcessor'

    spritesRawFolder = '../main/assets-raw/sprites/'
    spritesAssetsFolder = '../main/assets/sprites/'
}

dependencies {
    implementation project(':main')
    implementation "com.github.Anuken.Mindustry:core:$mindustryVersion"
}

task proc(dependsOn: [classes, configurations.runtimeClasspath]) {
    doLast {
        delete { delete spritesAssetsFolder }

        file(spritesAssetsFolder).mkdirs()

        copy {
            from spritesRawFolder
            into spritesAssetsFolder
        }

        javaexec {
            main imageProcessorMain
            classpath sourceSets.main.runtimeClasspath
            jvmArgs += '-Djava.awt.headless=true'
            standardInput System.in
            workingDir file('../main/assets/')
        }
    }
}
