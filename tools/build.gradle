sourceSets.main.java.srcDirs = [ "src/" ]

repositories{
    mavenCentral()
    maven{ url 'https://www.jitpack.io' }
}

ext{
    imageProcessorMain = "unity.tools.SpriteProcessor"

    spritesGenFolder = "../main/assets-raw/sprites-gen/"
    spritesGenUIFolder = "../main/assets-raw/sprites-gen/ui/"
    spritesAssetsFolder = "../main/assets/sprites/"
}

task processSprites(dependsOn: classes){
    doLast{
        delete{
            delete "$spritesGenFolder"
            delete "$spritesAssetsFolder"
        }

        file("$spritesGenFolder").mkdirs()
        file("$spritesGenUIFolder").mkdirs()

        javaexec{
            main = imageProcessorMain
            classpath = sourceSets.main.runtimeClasspath
            jvmArgs("-Djava.awt.headless=true")
            standardInput = System.in
            workingDir = "../main/assets-raw/"
        }

        file("$spritesAssetsFolder").mkdirs()

        copy{
            from "$spritesGenFolder"
            into "$spritesAssetsFolder"
        }
    }
}
